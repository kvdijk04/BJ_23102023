﻿@using BJ.Contract.Product;
@model IEnumerable<UserProductDto>
@{
    Layout = null;
}
@using Microsoft.Extensions.Configuration
@inject IConfiguration Configuration
@if (Model != null && Model.Count() > 0)
{
    @foreach (var product in Model.Where(x => x.Active == true))
    {
        <li class="drink-block" id="li_@product.Id" style="height: 380px;transition: all 1s linear 0s;">
            <a class="grid_item show-ing" id="grid_@product.Id" clicked="false" data-catName="@product.CatName" data-masp="@product.Id" data-proName="@product.ProductName" @* onclick="openTab('@product.Id');" *@>
                <img src="@Configuration["BaseAddress"]/ImageProduct/@product.ImagePathCup" />
                <img src="~/images/cup_shadow.png" />
                <img src="@Configuration["BaseAddress"]/ImageProduct/@product.ImagePathHero" class="topleft" />
                <img src="@Configuration["BaseAddress"]/ImageProduct/@product.ImagePathIngredients" />
                <ul>
                    @foreach (var subCat in product.UserSubCategorySpecificProductDto)
                    {
                        @foreach (var sub in subCat.SubCategoryDto.SubCategoryTranslationDtos)
                        {
                            if (sub != null)
                            {
                                <li><span><img src="@Configuration["BaseAddress"]/ImageSubCategory/@subCat.ImagePath"></span>@sub.SubCatName</li>
                            }
                            else
                            {
                                <li><span><img src="@Configuration["BaseAddress"]/ImageSubCategory/@subCat.ImagePath"></span></li>


                            }

                        }
                    }
                </ul>
                <span>@product.ProductName</span>
            </a>
            <div class="og-expander" id="@product.Id" style="transition: height 100ms ease 0s;display:none">
                <div class="preloader" style="display:none"><div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div></div>
            </div>

        </li>

    }
}
else
{
    <section id="hints" style="display: block;">
        <p> <img src="~/images/title_wait.png"> </p>
        <h3><localize>You want find drinks in this category?</localize></h3>
        <p><localize>There are no drinks in this category. Please come back later.</localize></p>
        <ul>
            <li class="filter1"><img src="~/images/hint-1.png">Strawberry</li>
            <li class="filter2"><img src="~/images/hint-2.png">Chocolate</li>
            <li class="filter3"><img src="~/images/hint-3.png">Pineapple</li>
            <li class="filter4"><img src="~/images/hint-4.png">Green Tea</li>
            <li class="filter5"><img src="~/images/hint-5.png">Coconut</li>
            <li class="filter6"><img src="~/images/hint-6.png">Milk</li>
            <li class="filter7"><img src="~/images/hint-7.png">Lemon</li>
        </ul>
    </section>
}

<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script>
    var first = $(location).attr('pathname');

    first.indexOf(1);

    first.toLowerCase();

    first = first.split("/")[1];
    $(".drink-block .grid_item").on("click", function (i) {

        var nameCat = $(this).attr("data-catName");
        var idPro = $(this).attr("data-masp");
        var namePro = $(this).attr("data-proName");

        var alias = $(this).attr("data-alias");
        var e = $(".drink-block .grid_item").index(this);

        if ($(this).attr("clicked") == "false") {

            $(".drink-block .og-expander:eq( " + e + " )").css("height", "1140");
            $(".drink-block:eq( " + e + " )").css("height", "1530");
            $(".drink-block:eq( " + e + " )").addClass(" og-expanded");
            $(".drink-block .grid_item:eq( " + e + " )").attr("clicked", "true");

            $('.drink-block .og-expander').not(':eq("' + e + '")').css("height", "");
            $('.drink-block .og-expander').not(':eq("' + e + '")').css("display", "none");

            $('.drink-block').not(':eq("' + e + '")').css("height", "380px");
            $('.drink-block').not(':eq("' + e + '")').removeClass(" og-expanded");
            $('.drink-block .grid_item').not(':eq("' + e + '")').attr("clicked", "false");

            document.getElementById(idPro).style.display = "block";
            $("#li_" + idPro).css("height", "1530px");
            $.ajax({
                url: '/singleproduct',
                datatype: "json",
                type: "get",
                data: { proId: idPro, culture : first },

                async: true,
                success: function (results) {
                    jQuery("#" + idPro).fadeOut(100, function () {
                        $("#" + idPro).html();
                        $("#" + idPro).html(results);
                    }).fadeIn(300);


                },
                error: function (xhr) {
                    alert('error');
                }
            });
            $("#li_" + idPro).addClass(" og-expanded");
            $(this).attr("clicked", "true");

        }
        else {

            document.getElementById(idPro).style.display = "none";

            $("#li_" + idPro).removeClass(" og-expanded");
            $("#li_" + idPro).css("height", "380px");
            $(this).attr("clicked", "false");
            $("#li_" + namePro).css("display", "none");
            $("#" + idPro).css("height", "");
        }
        i.preventDefault()



    });


</script>
